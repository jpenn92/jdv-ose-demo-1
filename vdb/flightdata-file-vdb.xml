<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<vdb name="flightdata-file" version="1">
    <model name="file">
        <source name="text-connector" translator-name="file" connection-jndi-name="java:/flightdata-file-DS"/>
    </model>
    <model name="flightdata" type="VIRTUAL">
        <metadata type="DDL"><![CDATA[
        CREATE VIEW FlightData (
            Id string PRIMARY KEY,
            Airline string,
	          FlightNo string,
	          SSN string,
            DepartLoc string,
            ArriveLoc string,
            TravelDate string            
        ) AS  
          SELECT SP.Id, SP.Airline, SP.FlightNo, SP.SSN, SP.DepartLoc, SP.ArriveLoc, SP.TravelDate
          FROM (EXEC file.getTextFiles('flight-data.txt')) AS f, 
            TEXTTABLE(f.file COLUMNS Id string, Airline string, FlightNo string, SSN string, DepartLoc string, ArriveLoc string, TravelDate string HEADER) AS SP;   
        ]]> </metadata>
    </model>
</vdb>
